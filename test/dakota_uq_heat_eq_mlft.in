#@ s*: Label=FastTest
#@ p0: MPIProcs=2
#@ p1: MPIProcs=3
#@ s*: TimeoutAbsolute=3600
#@ s*: TimeoutDelay=1200

#environment,
#	graphics

method,
	model_pointer = 'HIERARCH'
### MULTIFIDELITY ###
	multifidelity_function_train			     #s0,#s1,#s2,#s3,#s4
## No refinement:
	  collocation_points_sequence = 1000 400 200 100	#s0
#	  collocation_ratio = 1.75     	     	     		#s1
## Adaptive refinement: (individual, integrated)
# > FT can adapt along dimensions of both rank and order.  For now, we refine
#   order and rely on C3 adapt_rank (optionally):
# > spec supports start_{rank,order}_seq and colloc_pts_seq/plot_samples, which
#   specify _initial_ resolutions per level, prior to refinement/adaptation
# > Uniform refinement could support poly order (default) vs. rank (option)
#	  collocation_points_sequence = 100  40  20  10		#s2,#s3
#	  collocation_ratio = 1.75     	     	     		#s4
#	  p_refinement uniform					#s2,#s3,#s4
#	  allocation_control greedy				#s3
	  start_rank_sequence = 3 2 2 1 			#s0,#s1,#s2,#s4
#	  start_rank_sequence = 2 2 2 2	 adapt_rank		#s3
#
### MULTILEVEL ###
#	multilevel_function_train				#s5,#s6,#s7
#	  pilot_samples = 100 40 20 10				#s5,#s6
#	  collocation_ratio = 1.75				#s7
#	  allocation_control rank_sampling			#s5,#s7
#	  allocation_control estimator_variance			#s6
#          start_rank_sequence  = 2 2 2 2			#s5,#s6,#s7	
	  kick_rank = 2  max_rank  = 10
	  start_order_sequence = 2 2 2 2   max_order = 10
          solver_tolerance = 1e-8  rounding_tolerance = 1e-8
	  convergence_tol  = 1e-4
	  seed = 1237
	  output silent

model,
	id_model = 'HIERARCH'
	surrogate hierarchical
	  ordered_model_fidelities = 'SIM1'
	  correction = zeroth_order additive

model,
	id_model = 'SIM1'
	simulation
	  solution_level_control = 'N_x'
# linear in modes, linear in spatial coords:
#	  solution_level_cost = 630. 1260. 2100. 4200.
# linear in modes, cubic in spatial coords:
	  solution_level_cost = 567. 4536. 21000. 168000.

variables,
	uniform_uncertain = 7
	  lower_bounds    = 7*-1.
	  upper_bounds    = 7* 1.
	discrete_state_set integer = 2
#	  num_set_values = 6 2
#	  set_values = 5 15 30 60 100 200 # number of spatial coords
#	  	       3 21    	      	  # number of Fourier solution modes
	  num_set_values = 4 2
	  set_values = 30 60 100 200	  # number of spatial coords
	  	       3 21    	      	  # number of Fourier solution modes
	  initial_state = 30 21
	  descriptors 'N_x' 'N_mod'

interface,
	direct
	  analysis_driver = 'transient_diffusion_1d'

responses,
	response_functions = 1
	no_gradients
	no_hessians
