# Verify LHS operation with some variables that degenerate to
# constants (lb == ub or set of size 1) to protect bug fix in DP-798

# This test will generate lots of NaN correlations. If causes problems
# cross-platform, can find another approach to test. Verification of
# this test is partially manual, via inspecting the tabular data file,
# though some weak protection is offered by the moment stats.

environment
  tabular_data tabular_data_file 'dakota_lhs_constants.dat'

method
  sampling
    samples  60
    seed  1
    sample_type  lhs

variables
  active  all

  continuous_design  2
    descriptors   'cd1_const'  'cd2'
    lower_bounds  1.0           1.9
    upper_bounds  1.0           2.1

  discrete_design_range  2
    descriptors   'ddr3'  'ddr4_const'
    lower_bounds  2.0     4.0
    upper_bounds  4.0     4.0

  discrete_design_set
    integer  2
      descriptors     'dds5_const'  'dds6'
      num_set_values  1             3
          set_values  5             5 6 7

  # NOTE: uniform doesn't support const, while continuous design does...
  uniform_uncertain  1
    descriptors   'uu7'
    lower_bounds  0.06
    upper_bounds  0.08

  poisson_uncertain  1
    descriptors  'pu8'
    lambdas      8.0

  # NOTE: point histograms allow single values (constant), but can't
  # be correlated with others, so we verify that if correlation is
  # small enough it works.
  histogram_point_uncertain
    real  2
    descriptors         'hpui9'    'hpui10_const'
    pairs_per_variable  3          1 
    abscissas           8.9 9 9.1  10  
    counts              1   2 1    1

  # Should work as long as negligible correlation with hpui10
  uncertain_correlation_matrix
    # uu7  pu8  hpui9  hpui10
      1.0  0.2  0.3    0.0
      0.2  1.0  0.4    0.0
      0.3  0.4  1.0    0.0
      0.0  0.0  0.0    1.0

  continuous_state  1
    descriptors  'cs1_const'
    lower_bound  0.1
    upper_bound  0.1

  discrete_state_set
    integer  1
      descriptors  'dss2'
      set_values   2 22
  
    real  3
      descriptors            'dssr3_const' 'dssr4' 'dssr5_const'
      elements_per_variable  1             2       1
      set_values
        3
        0.4 4.0
        0.5

interface
  direct
    analysis_driver = 'text_book'

responses
  descriptors  'f' 'g1' 'g2'
  response_functions  3
  no_gradients
  no_hessians
